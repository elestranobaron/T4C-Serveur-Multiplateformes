// VaporizeUnit.cpp: implementation of the VaporizeUnit class.
//
//////////////////////////////////////////////////////////////////////
#include "stdafx.h"
#include "VaporizeUnit.h"
#include "../Players.h"
#include "../T4CLog.h"

//////////////////////////////////////////////////////////////////////
// Construction/Destruction
//////////////////////////////////////////////////////////////////////

VaporizeUnit::VaporizeUnit()
{

}

VaporizeUnit::~VaporizeUnit()
{

}

REGISTER_SPELL_EFFECT( VAPORIZE_UNIT, VaporizeUnit::NewFunc, VAPORIZE_UNIT_EFFECT, NULL );

//////////////////////////////////////////////////////////////////////////////////////////
BOOL VaporizeUnit::InputParameter
//////////////////////////////////////////////////////////////////////////////////////////
// Input parameter function
// 
(
 CString csParam,   // The parameter's value
 WORD wParamID      // The parameter's ID.
)
// Return: BOOL, TRUE
//////////////////////////////////////////////////////////////////////////////////////////
{
    return TRUE;
}
//////////////////////////////////////////////////////////////////////////////////////////
void VaporizeUnit::CallEffect
//////////////////////////////////////////////////////////////////////////////////////////
// This effect annihilates the given unit, if its not a player.
// 
(
 SPELL_EFFECT_PROTOTYPE
)
//////////////////////////////////////////////////////////////////////////////////////////
{
    if( self->GetType() == U_PC && target != NULL ){
        Character *lpCharacter = static_cast< Character * >( self );
        Players   *lpPlayer = lpCharacter->GetPlayer();
        
        if( lpPlayer != NULL && lpPlayer->GetGodFlags() & GOD_CAN_SLAY_USER ){
            _LOG_GAMEOP
                LOG_SYSOP,
                "Gameop %s (%s) cast vaporize on unit named %s.",
                (LPCTSTR)lpCharacter->GetTrueName(),
                (LPCTSTR)lpPlayer->GetFullAccountName(),
                (LPCTSTR)target->GetName( _DEFAULT_LNG )
            LOG_

            target->VaporizeUnit();
        }
    }
}

//////////////////////////////////////////////////////////////////////////////////////////
SpellEffect *VaporizeUnit::NewFunc
//////////////////////////////////////////////////////////////////////////////////////////
// Factory.
// 
(
 LPSPELL_STRUCT lpSpell // The spell structure.
)
// Return: SpellEffect, 
//////////////////////////////////////////////////////////////////////////////////////////
{
    CREATE_EFFECT_HANDLE( VaporizeUnit, 0 )
}