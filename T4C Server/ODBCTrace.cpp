//////////////////////////////////////////////////////////////////////////////////////////
//
//////////////////////////////////////////////////////////////////////////////////////////
#include "stdafx.h"
#include "ODBCTrace.h"
#include <vector>
#include "Lock.h"
//////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////

CLock ODBCTrace::cTraceLock;

//////////////////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////////////////////
ODBCTrace::ODBCTrace(){
	bTraceLock = false;
}
//////////////////////////////////////////////////////////////////////////////////////////
ODBCTrace::~ODBCTrace(){
}
//////////////////////////////////////////////////////////////////////////////////////////
void ODBCTrace::addRequest(CString request){

	vecRequest.push_back( request );
	if( vecRequest.size() > VECTOR_SIZE ){
		//Remove the first (oldest) element
		vecRequest.erase( vecRequest.begin() );
	}

}
//////////////////////////////////////////////////////////////////////////////////////////
void ODBCTrace::addDuration(unsigned long duration){

	vecDuration.push_back( duration );
	if( vecDuration.size() > VECTOR_SIZE ){
		//Remove the first (oldest) element
		vecDuration.erase( vecDuration.begin() );
	}

}
//////////////////////////////////////////////////////////////////////////////////////////
void ODBCTrace::Lock(){

//	while(bTraceLock){
//	}
//    bTraceLock = true;
	
	cTraceLock.Lock();

}
//////////////////////////////////////////////////////////////////////////////////////////
void ODBCTrace::Unlock(){

//	bTraceLock = false;

	cTraceLock.Unlock();

}
//////////////////////////////////////////////////////////////////////////////////////////
csVectorRequest ODBCTrace::getVectorRequest(){

	return vecRequest;

}
//////////////////////////////////////////////////////////////////////////////////////////
loVectorDuration ODBCTrace::getVectorDuration(){

	return vecDuration;

}
