// IcySaber.cpp: implementation of the IcySaber class.
//
//////////////////////////////////////////////////////////////////////
#include "stdafx.h"
#include "IcySaber.h"

//////////////////////////////////////////////////////////////////////
// Construction/Destruction
//////////////////////////////////////////////////////////////////////

IcySaber::IcySaber()
{

}

IcySaber::~IcySaber()
{

}
            
//////////////////////////////////////////////////////////////////////////////////////////
void IcySaber::OnAttack
//////////////////////////////////////////////////////////////////////////////////////////
// When a sword attacks
// 
(
 UNIT_FUNC_PROTOTYPE // sword prototype 
)
//////////////////////////////////////////////////////////////////////////////////////////
{

	LPATTACK_STRUCTURE Blow = (LPATTACK_STRUCTURE)valueIN;
	if(Blow){		
		int nSabreStr = self->ViewFlag( __FLAG_ICY_SABER );
		Blow->Strike += ( rnd.roll( dice( ( nSabreStr / 5 ), 5 ) ) + ( nSabreStr / 4 ) );
	}
}


//////////////////////////////////////////////////////////////////////////////////////////
void IcySaber::OnDisturbed
//////////////////////////////////////////////////////////////////////////////////////////
// If IcySaber is disturbed.
// 
(
 UNIT_FUNC_PROTOTYPE
)
//////////////////////////////////////////////////////////////////////////////////////////
{
	LPDWORD lpdwReason = ( LPDWORD )( valueIN );

	if( *lpdwReason == OBJECT_DISTURB_DROP ||
		*lpdwReason == OBJECT_DISTURB_ROB  ||
		*lpdwReason == OBJECT_DISTURB_GET ){
		
		self->SetMark( MARK_DELETION );

	}


}

//////////////////////////////////////////////////////////////////////////////////////////
ObjectStructure *IcySaber::CreateObject( void ){
	return new IcySaber;
}